{% if groups['master'] | length == 1 %}
<<<<<<< HEAD
    {% set apiserver = groups['master'][0] + ':' + '6443' %}
{% elif groups['master'] | length > 1 %}
    {% set apiserver = vip + ':' + '16443' %}
=======
    {% set apiserver = groups['master'][0] %}
{% elif groups['master'] | length > 1 %}
    {% set apiserver = vip %}
>>>>>>> c9279f55328d7a73c6a5970a1ce788ea2c9d47b5
{% endif %}

apiVersion: v1
clusters:
- cluster:
    certificate-authority: {{ k8s_work_dir }}/ssl/ca.pem
<<<<<<< HEAD
    server: https://{{ apiserver }}
=======
    server: https://{{ apiserver }}:6443
>>>>>>> c9279f55328d7a73c6a5970a1ce788ea2c9d47b5
  name: kubernetes
contexts:
- context:
    cluster: kubernetes
    user: kube-proxy
  name: default
current-context: default
kind: Config
preferences: {}
users:
- name: kube-proxy
  user:
    client-certificate: {{ k8s_work_dir }}/ssl/kube-proxy.pem
    client-key: {{ k8s_work_dir }}/ssl/kube-proxy-key.pem
